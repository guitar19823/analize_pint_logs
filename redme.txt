ПОЯСНЕНИЯ К РАБОТЕ КОДА


1. Структура данных:
   - LogEntry — исходная запись лога (dateTime, name, value).
   - ProcessNode — узел дерева процессов с полями:
     * name, start, end, value — основные данные;
     * duration — вычисляется как разница между end и start (в мс);
     * children — дочерние процессы;
     * isExpanded — флаг развёрнутости узла;
     * parent — ссылка на родительский узел (для внутренней логики).


2. ProcessTreeBuilder:
   - Строит иерархическое дерево на основе логов.
   - Использует стек для отслеживания вложенности:
     * При 'start' — создаёт узел и кладёт в стек.
     * При 'end' — извлекает из стека, заполняет end и duration.
     * Прочие значения — добавляются как листовые узлы.


3. TableRenderer:
   - Формирует текстовую таблицу с фиксированными ширинами колонок.
   - Шапка: «Название», «Начало», «Конец», «Длительность», «Значение».
   - Для каждого узла:
     * Если есть дети — показывает '+' (схлопнут) или '−' (развёрнут).
     * Длительность форматируется как «X.XXXs».
     * Выбранный узел выделяется символом '>' слева.

4. TUIController:
   - Управляет вводом через readline.
   - Обрабатывает клавиши:
     * up/down — перемещение по строкам;
     * left/right — сворачивание/разворачивание;
     * q или Ctrl+C — выход.
   - Перерисовывает таблицу при любом действии.
   - Очистка экрана через ANSI-код \x1Bc (поддерживается в большинстве терминалов).


5. Запуск:
   - Передайте массив логов в TUIController.
   - Вызовите start() — начнётся интерактивное отображение.


ОГРАНИЧЕНИЯ И ПРИМЕЧАНИЯ


- Нет внешних зависимостей — только встроенные модули Node.js.
- Для работы в Windows рекомендуется PowerShell или Git Bash (из-за ANSI-кодов).
- Размер таблицы фиксирован (рассчитывается один раз).
- Фокус всегда остаётся на текущем элементе благодаря перерисовке.
- Дерево строится один раз; изменение isExpanded не перестраивает структуру.


КАК ЗАПУСТИТЬ


1. Сохраните код в файл, например, log-viewer.ts.
2. Установите Node.js (если не установлен).
3. Выполните: npx ts-node log-viewer.ts
   (или скомпилируйте через tsc и запустите через node).